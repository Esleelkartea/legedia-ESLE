<?php
// auto-generated by sfAdvancedAdmin
// date: 2008/01/10 11:37:49
?>
<?php use_helper('Object') ?>

<div class="sf_admin_filters">
<?php echo form_tag('sesiones/list', array('method' => 'get')) ?>

  <fieldset>
    <h2><?php echo __('filters') ?></h2>
    <!--
    <div class="form-row">
    <label for="id_sesion"><?php echo __('Sesion') ?>:</label>
    <div class="content">
    <?php echo input_tag('filters[id_sesion]', isset($filters['id_sesion']) ? $filters['id_sesion'] : null, array (
  'size' => 15,
)) ?>
    </div>
    </div>
-->
        <div class="form-row">
    <label for="id_usuario"><?php echo __($labels['sesion{idusuario}']) ?></label>
    <div class="content">
    <?php /*echo input_tag('filters[id_usuario]', isset($filters['id_usuario']) ? $filters['id_usuario'] : null, array (
  'disabled' => true,
)) */?>
	<?php echo object_select_tag(isset($filters['id_usuario']) ? $filters['id_usuario'] : null, null, array (
  'include_blank' => true,
  'related_class' => 'Usuario',
  'text_method' => '__toString',
  'control_name' => 'filters[id_usuario]',
)) ?>	


    </div>
    </div>
<!--
        <div class="form-row">
    <label for="sesion"><?php echo __('Sesion:') ?></label>
    <div class="content">
    <?php echo input_tag('filters[sesion]', isset($filters['sesion']) ? $filters['sesion'] : null, array (
  'size' => 15,
)) ?>
    </div>
    </div>
-->
        <div class="form-row">
    <label for="ip"><?php echo __($labels['sesion{ip}']) ?></label>
    <div class="content">
    <?php echo input_tag('filters[ip]', isset($filters['ip']) ? $filters['ip'] : null, array (
  'size' => 15,
)) ?>
    </div>
    </div>

      <div class="form-row">
    <label for="modulo"><?php echo __($labels['sesion{modulo}']) ?></label>
    <div class="content">
    <?php /*echo input_tag('filters[modulo]', isset($filters['modulo']) ? $filters['modulo'] : null, array (
  'size' => 15,
)); */
        $conexion = Propel::getConnection();
        $consulta = "SELECT DISTINCT(modulo) FROM sesion_log WHERE modulo IS NOT NULL";
        if (isset($filters['id_sesion'])) $consulta .= " AND id_sesion = '".$filters['id_sesion']."'";
        $consulta .= " ORDER BY modulo";

        $sentencia = $conexion->prepare($consulta);
        $sentencia->execute();

     ?>
     <select name="filters[modulo]" id="filters_modulo">
     	<option value="" <?php if (!isset($filters['modulo'])) echo 'selected'?>></option>
            <?php while ($resulset = $sentencia->fetch()) { ?>
            <option value="<?php echo $resulset['modulo']?>" <?php if (isset($filters['modulo']) && $filters['modulo'] == $resulset['modulo']) echo 'selected'?>><?php echo  $resulset['modulo']?></option>
        <?php } ?>
     
     </select>


    </div>
    </div>
    
   <div class="form-row">
    <label for="fecha"><?php echo __($labels['sesion{fecha}']) ?></label>
    <div class="content">
    <?php echo input_date_range_tag('filters[fecha]', isset($filters['fecha']) ? $filters['fecha'] : null, array (
  'rich' => true,
  'withtime' => true,
  'calendar_button_img' => '/sf/sf_admin/images/date.png',
  'date_format' => 'dd/MM/yyyy HH:mm',
  'size' => '9'
)) ?>
    </div>
    </div>



      </fieldset>

  <ul class="sf_admin_actions">
    <li><?php echo button_to(__('reset'), 'sesiones/list?filter=filter', 'class=sf_admin_action_reset_filter') ?></li>
    <li><?php echo submit_tag(__('filter'), 'name=filter class=sf_admin_action_filter') ?></li>
  </ul>

</form>
</div>
